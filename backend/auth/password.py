"""Password hashing using Argon2 (fallback to bcrypt if unavailable)."""

try:
    from passlib.context import CryptContext
    _ctx = CryptContext(schemes=["argon2"], deprecated="auto")
except Exception:
    try:
        _ctx = CryptContext(schemes=["bcrypt"], deprecated="auto")
    except Exception:
        _ctx = CryptContext(schemes=["bcrypt"], deprecated="auto")


def hash_password(plain: str) -> str:
    return _ctx.hash(plain)


def verify_password(plain: str, hashed: str) -> bool:
    return _ctx.verify(plain, hashed)
